SET escape_string_warning=off;
SET
SET escape_string_warning=off;
SET
SELECT assert_eq('version', (SELECT fhir_conformance('{"version":"version"}'))->>'version', 'version');
 assert_eq  
------------
 OK version
(1 row)

SELECT assert_eq('Patient',
   (fhir_profile(null::jsonb, 'Patient')#>>'{structure,0,differential,element,0,path}'),
  'conformance');
   assert_eq    
----------------
 OK conformance
(1 row)

SELECT fhir_profile(null::jsonb, 'Patient');
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   fhir_profile                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"name": "Patient", "structure": [{"type": "Patient", "publish": true, "searchParam": [{"name": "active", "type": "token", "xpath": "Patient/active", "documentation": "Whether the patient record is active"}, {"name": "address", "type": "string", "xpath": "Patient/address", "documentation": "An address in any kind of address/part of the patient"}, {"name": "animal-breed", "type": "token", "xpath": "Patient/animal/breed", "documentation": "The breed for animal patients"}, {"name": "animal-species", "type": "token", "xpath": "Patient/animal/species", "documentation": "The species for animal patients"}, {"name": "birthdate", "type": "date", "xpath": "Patient/birthDate", "documentation": "The patient's date of birth"}, {"name": "careprovider", "type": "reference", "xpath": "Patient/careProvider", "documentation": "Patient's nominated care provider, could be a care manager, not the organization that manages the record"}, {"name": "family", "type": "string", "xpath": "Patient/name/family", "documentation": "A portion of the family name of the patient"}, {"name": "gender", "type": "token", "xpath": "Patient/gender", "documentation": "Gender of the patient"}, {"name": "given", "type": "string", "xpath": "Patient/name/given", "documentation": "A portion of the given name of the patient"}, {"name": "identifier", "type": "token", "xpath": "Patient/identifier", "documentation": "A patient identifier"}, {"name": "language", "type": "token", "xpath": "Patient/communication", "documentation": "Language code (irrespective of use value)"}, {"name": "link", "type": "reference", "xpath": "Patient/link/other", "documentation": "All patients linked to the given patient"}, {"name": "name", "type": "string", "xpath": "Patient/name", "documentation": "A portion of either family or given name of the patient"}, {"name": "organization", "type": "reference", "xpath": "Patient/managingOrganization", "documentation": "The organization at which this person is a patient"}, {"name": "telecom", "type": "string", "xpath": "Patient/telecom", "documentation": "The value in any kind of telecom details of the patient"}], "differential": {"element": [{"path": "Patient", "definition": {"max": "1", "min": "1", "type": []}}, {"path": "Patient.active", "definition": {"max": "1", "min": "0", "type": [{"code": "boolean"}]}}, {"path": "Patient.address", "definition": {"max": "*", "min": "0", "type": [{"code": "Address"}]}}, {"path": "Patient.animal", "definition": {"max": "1", "min": "0", "type": []}}, {"path": "Patient.animal.breed", "definition": {"max": "1", "min": "0", "type": [{"code": "CodeableConcept"}]}}, {"path": "Patient.animal.extension", "definition": {"max": "*", "min": "0", "type": [{"code": "Extension"}]}}, {"path": "Patient.animal.genderStatus", "definition": {"max": "1", "min": "0", "type": [{"code": "CodeableConcept"}]}}, {"path": "Patient.animal.id", "definition": {"max": "1", "min": "0", "type": [{"code": "id"}]}}, {"path": "Patient.animal.modifierExtension", "definition": {"max": "*", "min": "0", "type": [{"code": "Extension"}]}}, {"path": "Patient.animal.species", "definition": {"max": "1", "min": "1", "type": [{"code": "CodeableConcept"}]}}, {"path": "Patient.birthDate", "definition": {"max": "1", "min": "0", "type": [{"code": "date"}]}}, {"path": "Patient.careProvider", "definition": {"max": "*", "min": "0", "type": [{"code": "Reference"}, {"code": "Reference"}]}}, {"path": "Patient.communication", "definition": {"max": "*", "min": "0", "type": [{"code": "CodeableConcept"}]}}, {"path": "Patient.contact", "definition": {"max": "*", "min": "0", "type": []}}, {"path": "Patient.contact.address", "definition": {"max": "1", "min": "0", "type": [{"code": "Address"}]}}, {"path": "Patient.contact.extension", "definition": {"max": "*", "min": "0", "type": [{"code": "Extension"}]}}, {"path": "Patient.contact.gender", "definition": {"max": "1", "min": "0", "type": [{"code": "code"}]}}, {"path": "Patient.contact.id", "definition": {"max": "1", "min": "0", "type": [{"code": "id"}]}}, {"path": "Patient.contact.modifierExtension", "definition": {"max": "*", "min": "0", "type": [{"code": "Extension"}]}}, {"path": "Patient.contact.name", "definition": {"max": "1", "min": "0", "type": [{"code": "HumanName"}]}}, {"path": "Patient.contact.organization", "definition": {"max": "1", "min": "0", "type": [{"code": "Reference"}]}}, {"path": "Patient.contact.period", "definition": {"max": "1", "min": "0", "type": [{"code": "Period"}]}}, {"path": "Patient.contact.relationship", "definition": {"max": "*", "min": "0", "type": [{"code": "CodeableConcept"}]}}, {"path": "Patient.contact.telecom", "definition": {"max": "*", "min": "0", "type": [{"code": "ContactPoint"}]}}, {"path": "Patient.contained", "definition": {"max": "*", "min": "0", "type": [{"code": "Resource"}]}}, {"path": "Patient.deceased[x]", "definition": {"max": "1", "min": "0", "type": [{"code": "boolean"}, {"code": "dateTime"}]}}, {"path": "Patient.extension", "definition": {"max": "*", "min": "0", "type": [{"code": "Extension"}]}}, {"path": "Patient.gender", "definition": {"max": "1", "min": "0", "type": [{"code": "code"}]}}, {"path": "Patient.id", "definition": {"max": "1", "min": "0", "type": [{"code": "id"}]}}, {"path": "Patient.identifier", "definition": {"max": "*", "min": "0", "type": [{"code": "Identifier"}]}}, {"path": "Patient.implicitRules", "definition": {"max": "1", "min": "0", "type": [{"code": "uri"}]}}, {"path": "Patient.language", "definition": {"max": "1", "min": "0", "type": [{"code": "code"}]}}, {"path": "Patient.link", "definition": {"max": "*", "min": "0", "type": []}}, {"path": "Patient.link.extension", "definition": {"max": "*", "min": "0", "type": [{"code": "Extension"}]}}, {"path": "Patient.link.id", "definition": {"max": "1", "min": "0", "type": [{"code": "id"}]}}, {"path": "Patient.link.modifierExtension", "definition": {"max": "*", "min": "0", "type": [{"code": "Extension"}]}}, {"path": "Patient.link.other", "definition": {"max": "1", "min": "1", "type": [{"code": "Reference"}]}}, {"path": "Patient.link.type", "definition": {"max": "1", "min": "1", "type": [{"code": "code"}]}}, {"path": "Patient.managingOrganization", "definition": {"max": "1", "min": "0", "type": [{"code": "Reference"}]}}, {"path": "Patient.maritalStatus", "definition": {"max": "1", "min": "0", "type": [{"code": "CodeableConcept"}]}}, {"path": "Patient.meta", "definition": {"max": "1", "min": "0", "type": []}}, {"path": "Patient.meta.extension", "definition": {"max": "*", "min": "0", "type": [{"code": "Extension"}]}}, {"path": "Patient.meta.id", "definition": {"max": "1", "min": "0", "type": [{"code": "id"}]}}, {"path": "Patient.meta.lastUpdated", "definition": {"max": "1", "min": "0", "type": [{"code": "instant"}]}}, {"path": "Patient.meta.modifierExtension", "definition": {"max": "*", "min": "0", "type": [{"code": "Extension"}]}}, {"path": "Patient.meta.profile", "definition": {"max": "*", "min": "0", "type": [{"code": "uri"}]}}, {"path": "Patient.meta.security", "definition": {"max": "*", "min": "0", "type": [{"code": "Coding"}]}}, {"path": "Patient.meta.tag", "definition": {"max": "*", "min": "0", "type": [{"code": "Coding"}]}}, {"path": "Patient.meta.versionId", "definition": {"max": "1", "min": "0", "type": [{"code": "id"}]}}, {"path": "Patient.modifierExtension", "definition": {"max": "*", "min": "0", "type": [{"code": "Extension"}]}}, {"path": "Patient.multipleBirth[x]", "definition": {"max": "1", "min": "0", "type": [{"code": "boolean"}, {"code": "integer"}]}}, {"path": "Patient.name", "definition": {"max": "*", "min": "0", "type": [{"code": "HumanName"}]}}, {"path": "Patient.photo", "definition": {"max": "*", "min": "0", "type": [{"code": "Attachment"}]}}, {"path": "Patient.telecom", "definition": {"max": "*", "min": "0", "type": [{"code": "ContactPoint"}]}}, {"path": "Patient.text", "definition": {"max": "1", "min": "0", "type": [{"code": "Narrative"}]}}]}}], "resourceType": "Profile"}
(1 row)

