<!DOCTYPE html>
<html>
  <head>
  <meta charset='UTF-8'>
  <title>CoffeeScript API Documentation</title>
  <script src='../javascript/application.js'></script>
  <script src='../javascript/search.js'></script>
  <link rel='stylesheet' href='../stylesheets/application.css' type='text/css'>
</head>
  <body>
    <div id='base' data-path='../'></div>
<div id='header'>
  <div id='menu'>
    <a href='../extra/README.md.html' title='Fhirbase'>
      Fhirbase
    </a>
    &raquo;
    <a href='../alphabetical_index.html' title='Index'>
      Index
    </a>
    &raquo;
    <span class='title'>README.md</span>
  </div>
</div>
    <div id='content'>
      <nav class='toc'>
        <p class='title'>
          <a class='hide_toc' href='#'>
            <strong>Table of Contents</strong>
          </a>
          <small>
            (<a class='float_toc' href='#'>left</a>)
          </small>
        </p>
      </nav>
      <div id='filecontents'>
        <h1 id="fhirbase-plv8">fhirbase-plv8</h1><p><a href="https://travis-ci.org/fhirbase/fhirbase-plv8"><img src="https://travis-ci.org/fhirbase/fhirbase-plv8.svg" alt="Build Status"></a></p><p>This is attempt <em>rework</em> of fhirbase, i.e. fhirbase-2.</p><h1 id="why-">Why?</h1><p>There are couple of reasons to rewrite and redesign fhirbase:</p><h3 id="switch-primary-language-to-javascript">Switch primary language to JavaScript</h3><p>fhirbase was written mostly in sql &amp; pl/pgsql, but development using
this langs is quite cryptic and there are not so much developers ready to contribute.</p><p>We hope, that by switching essential part of code base to more pop-language like JavaScript (Coffee script)
make threshold lower and bring more developers to fhirbase.</p><p>Most utils around fhirbase like tests, migrations, maintenance tasks could be written using JS (node) stack
and that unify development. Also we can ruse existing node/js infrastructure and libraries like npm.</p><p>Another reason for JS: that we could develop pure js library for FHIR Resources Profile Validation and other FHIR stuff and reuse
it in database, in browser and on the servers side (node or embeded js).</p><h3 id="separation-of-concerns">Separation of concerns</h3><p>Redesign fhirbase in a way, that we could separate
fhirbase meta-layer (basic CRUD, search, tables, history),
which does not require FHIR meta-information and then build FHIR operations
on top of it.</p><p>This is good, because  FHIR meta data is changing actively, so we should
adopt this into evalulation workflow, i.e. core of fhirbase should work without concrete FHIR
metadata making as less asumptions on it as possible.</p><p>This approach gives users possibility to extend fhirbase for specific needs without
strictly coupling to FHIR - for example create FHIR-like resources, which never be part of FHIR,
but with almost the same operations and structure.</p><h2 id="preview">Preview</h2><p>Architecture sketch:</p><h2 id="layer-0-utils-as-separate-standalone-module-">LAYER 0: utils (as separate standalone module)</h2>
<ul>
<li>dev in node / build into pg</li>
<li>migrations utils</li>
<li>js modules to plv8</li>
<li>test in node</li>
</ul>
<h2 id="layer-1-core">LAYER 1: core</h2><p>This layer is almost FHIR agnostic. 
It should give convinient primitives to next FHIR related layer.</p><ul>
<li>schema management for RESOURCES</li>
<li>CRUD &amp; HISTORY implementation for Resources</li>
<li>Low level SEARCH<ul>
<li>element&#39;s granular query language</li>
<li>indexing</li>
</ul>
</li>
<li>interceptors for CRUD</li>
<li>OPERATIONS as a pg function</li>
</ul><p>API:</p><pre><code>core.generate_storage(&#39;ResourceType&#39;) // create tables for resource &amp; history
core.drop_storage(&#39;ResourceType&#39;) // drop tables
core.storages() // meta-data about generated storages

core.create(resource)
core.load(resourcesBundle)
core.merge(resourcesBundle)

core.read({resourceType, id})
core.vread({resourceType, id, vid})
core.update(resource)
core.delete(resource{resourceType, id})
core.history({resourceType, id})

core.search({resourceType, query})
[path op value]
</code></pre><p>Query language:</p><pre><code>exp = [path op value]
[&#39;.name.0.given&#39;, &#39;=&#39;, &#39;Petr&#39;] // search by element
[&#39;..id&#39;, &#39;=&#39;, &#39;???&#39;] // search by columns (id, vid, created_at, updated_at)
[&#39;..updated_at&#39;, &#39;between&#39;, &#39;2011-01-01&#39;, &#39;2015-01-01&#39;]
[&#39;name&#39;, &#39;contains&#39;, &#39;Pet&#39;]

Combine expressions:

[&#39;and&#39;, exp, exp, exp] =&gt; exp AND exp AND exp
[&#39;or&#39;, exp, exp, exp] =&gt; exp AND exp AND exp
</code></pre><h2 id="layer-1-fhirbase-core">LAYER 1: fhirbase core</h2>
<ul>
<li>generate tables for resource &amp; history</li>
<li>basic CRUD:  create, update, read, delete, history</li>
<li>register postgresql functions as operations</li>
<li>basic interceptors for operations: for example register validation interceptor for create Patient</li>
<li>basic search &amp; indexing: search, where query has enough metadata to build SQL
for example: search(&#39;Patient&#39;, &#39;{params: [{path: &quot;name.#.given&quot;, type: &#39;text&#39;, element: {type: &quot;String&quot;, array: true}]}&#39;)</li>
<li>referential consistency checks</li>
</ul>
<h2 id="layer-1-fhir-impl">LAYER 1: FHIR impl</h2>
<ul>
<li>storage for FHIR metadata:  structure def, operations, search params, valuesets</li>
<li>implement FHIR crud &amp; search using metadata on top of basic crud</li>
<li>resources validation &amp; ref. consistency checks</li>
<li>terminology implementation</li>
<li>transaction impl</li>
</ul>
<h2 id="extensions">EXTENSIONS</h2>
<ul>
<li>terminology extensions: LOINC, SNOMED, RxNORM etc</li>
<li>maintains utils</li>
</ul>

      </div>
    </div>
    <div id='footer'>
  October 26, 15 15:33:30 by
  <a href='https://github.com/coffeedoc/codo' title='CoffeeScript API documentation generator'>
    Codo
  </a>
  2.0.11
  &#10034;
  Press H to see the keyboard shortcuts
  &#10034;
  <a href='http://twitter.com/netzpirat' target='_parent'>@netzpirat</a>
  &#10034;
  <a href='http://twitter.com/_inossidabile' target='_parent'>@_inossidabile</a>
</div>
<iframe id='search_frame'></iframe>
<div id='fuzzySearch'>
  <input type='text'>
  <ol></ol>
</div>
<div id='help'>
  <p>
    Quickly fuzzy find classes, mixins, methods, file:
  </p>
  <ul>
    <li>
      <span>T</span>
      Open fuzzy finder dialog
    </li>
  </ul>
  <p>
    Control the navigation frame:
  </p>
  <ul>
    <li>
      <span>L</span>
      Toggle list view
    </li>
    <li>
      <span>C</span>
      Show class list
    </li>
    <li>
      <span>I</span>
      Show mixin list
    </li>
    <li>
      <span>F</span>
      Show file list
    </li>
    <li>
      <span>M</span>
      Show method list
    </li>
    <li>
      <span>E</span>
      Show extras list
    </li>
  </ul>
  <p>
    You can focus and blur the search input:
  </p>
  <ul>
    <li>
      <span>S</span>
      Focus search input
    </li>
    <li>
      <span>Esc</span>
      Blur search input
    </li>
  </ul>
</div>
  </body>
</html>