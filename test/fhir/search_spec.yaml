resources: ['patient', 'encounter']
fixtures:
  - {id: 'nicola', resourceType: 'Patient', name: [{given: ['nicola']}], active: true, birthDate: '1980'}
  - {resourceType: 'Patient', name: [{given: ['noise1']}], birthDate: '1970'}
  - {resourceType: 'Patient', name: [{given: ['noise2']}], birthDate: '1971'}
  - {resourceType: 'Patient', name: [{given: ['ivan']}], active: true , birthDate: '1981'}
  - {resourceType: 'Patient', name: [{given: ['Avraam']}, {given: ['Lincoln']}], birthDate: '1988', multipleBirthInteger: 3}
  - {resourceType: 'Patient', name: [{given: ['Cheburashka']}], birthDate: '1972', multipleBirthInteger: 2}
  - {resourceType: 'Encounter', patient: {reference: 'Patient/nicola'}, status: 'planned'}
  - {resourceType: 'Encounter', patient: {reference: 'Patient/noise'},  status: 'planned'}
  - {resourceType: 'Encounter', patient: {reference: 'Patient/noise2'},  status: 'planned'}

queries:
  Patient:
    - query: 'name=nicola'
      total: 1
      probes:
        - path: ['entry',0,'resource', 'name',0, 'given',0]
          result: 'nicola'
        - path: ['total']
          result: 1
    - query: 'name=noise'
      total: 2
      probes:
        - path: ['total']
          result: 2
    - query: 'name=nicola, ivan'
      total: 2
      probes:
        - path: ['total']
          result: 2
    - query: 'name=lincol'
      total: 1
      probes:
        - path: ['total']
          result: 1
        - path: ['entry',0,'resource', 'name',0, 'given',0]
          result: 'Avraam'
    - query: 'active=true'
      total: 2
      probes:
        - path: ['total']
          result: 2
    - query: 'birthdate=gt1980'
      total: 3
      probes:
        - path: ['total']
          result: 3
        - path: ['entry', 'length']
          result: 3
    - query: 'birthdate=gt1985'
      total: 1
      probes:
        - path: ['total']
          result: 1
    - query: 'birthdate=lt1970-05'
      total: 1
      probes:
        - path: ['total']
          result: 1
    - query: 'birthdate=lt1970-05'
      total: 1
      probes:
        - path: ['total']
          result: 1
  Encounter:
    - query: 'patient=Patient/nicola'
      total: 1
      probes:
        - path: ['total']
          result: 1
    - query: 'patient:Patient.name=nicola'
      total: 1
      probes:
        - path: ['total']
          result: 1
